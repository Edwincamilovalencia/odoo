<odoo>
  <data>
    <!--**********************Proyectos***************************** -->

    <!-- Accion al ejecutar el menu de proyectos -->
    <record id="action_proyectos" model="ir.actions.act_window">
      <field name="name">Proyectos</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">project.project</field>
      <field name="view_mode">tree,kanban,form</field>
      <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
          Crear nuevo proyecto!
        </p>
        <p>
          Sin mensaje... 
        </p>
      </field>
    </record>

    <!-- Definición vista kanban de proyectos -->
    <record id="proyectos_kanban" model="ir.ui.view">
      <field name="name">project.project.kanban</field>
      <field name="model">project.project</field>
      <field name="priority">1</field>
      <field name="arch" type="xml">

        <kanban default_group_by="pro_fase" records_draggable="true">
          <field name="name" />
          <field name="pro_lider" />
          <field name="pro_fase" />
          <templates>
            <t t-name="kanban-box">
              <div class="oe_kanban_global_click o_kanban_record_has_image_fill">
                <div class="oe_kanban_details">
                  <strong class="o_kanban_record_title">
                    <field name="name" />
                    <div class="o_kanban_tags_section" />
                    <ul>
                      <li>
                        <field name="pro_lider" />
                        <field name="date_start" />
                      </li>
                      <li>
                        <field name="pro_fase" />
                        <field name="date" string="Fecha fin" />
                      </li>
                    </ul>
                  </strong>

                </div>
              </div>
            </t>
          </templates>
        </kanban>
      </field>
    </record>

    <!-- Definición vista lista de proyectos -->
    <record id="proyectos_tree" model="ir.ui.view">
      <field name="name">project.project.tree</field>
      <field name="model">project.project</field>
      <field name="priority">1</field>
      <field name="arch" type="xml">
        <tree string="Proyecto">
          <field name="name" />
          <field name="pro_lider" />
          <field name="pro_fase" />
        </tree>
      </field>
    </record>


    <!-- Definición vista formulario de proyectos -->
    <record id="proyectos_form" model="ir.ui.view">
      <field name="name">project.project.form</field>
      <field name="model">project.project</field>
      <field name="priority">1</field>
      <field name="arch" type="xml">
        <form string="Gestion de Proyectos">
          <header>
            <button type="object" id="action_start" name="action_start" class="btn btn-primary" string="Iniciar" confirm="Iniciar fases del proyecto?" modifiers="{'invisible':[('pro_fase','!=', 'borrador')]}"/>
            <button type="object" id="action_next" name="action_next" class="btn btn-primary" string="Finalizar fase" confirm="Está seguro que desea pasar a la siguiente fase?" modifiers="{'invisible':[('pro_fase','in', ('borrador', 'cierre'))]}"/>
            <field name="pro_fase" widget="statusbar" statusbar_visible="planeacion,ejecucion,cierre"/>
          </header>
          <sheet>
            <h1 class="text-primary">
              <field name="name" modifiers="{'readonly':[('pro_fase','!=', 'borrador')]}"/>
            </h1>
            <hr />
            <group string="Datos del Proyecto">
              <group>
                <field name="date_start" modifiers="{'readonly':[('pro_fase','not in', ('borrador', 'planeacion'))]}"/>
                <field name="pro_porcentaje_ejecucion" string="% Ejecución proyecto" />
              </group>
              <group>
                <field name="date" string="Fecha fin" modifiers="{'readonly':[('pro_fase','not in', ('borrador', 'planeacion'))]}" />
                <field name="pro_lider" string="Líder" modifiers="{'readonly':[('pro_fase','not in', ('borrador', 'planeacion'))]}"/>
                <field name="pro_cierre_forzado" modifiers="{'invisible':[('pro_fase','!=', 'ejecucion')]}" />
              </group>
            </group>
            <br />
            <notebook>
              <page name='componentes_page' string="Componentes" modifiers="{'invisible':[('pro_fase','in', ('borrador', 'propuesta', 'formulacion'))]}" >
                <group col="2">
                  <field colspan="2" name="pro_componentes_ids" nolabel="1">
                    <tree editable="bottom" create="false" domain="[('pro_tipo', '=', 'componente')]">
                      <field name="name" readonly="1"/>
                      <field name="pro_peso" readonly="1"/>
                      <field name="pro_porcentaje_ejecucion" readonly="1" widget="progressbar"/>
                      <button type="object" id="action_open" name="action_open" class="btn btn-primary fa o_external_button fa-arrow-right" />
                    </tree>
                  </field>
                </group>
                <group>
                  <button id="action_adicionar_unidad" class="btn btn-xs btn-primary" name="action_adicionar_unidad" string="Adicionar" type="object" />
                </group>
              </page>
              <page name='requisitos_page' string="Requisitos">
                <field name="pro_requisitos_ids" nolabel="1" domain="[('project_id', '=', id)]">
                  <tree editable="bottom">
                    <field name="fase" modifiers="{'readonly':[('visible','=', True)]}"/>
                    <field name="name" modifiers="{'readonly':[('visible','=', True)]}" />
                    <field name="visible" invisible="1"/>
                    <field name="project_fase" invisible="1"/>
                    <field name="nota" modifiers="{'invisible':[('visible','=', False)],'readonly':[('project_fase','=', False)]}"/>
                    <field name="adjunto_name" invisible="1" />
                    <field name="adjunto" filename="adjunto_name" widget="binary" modifiers="{'invisible':[('visible','=', False)],'readonly':[('project_fase','=', False)]}"/>
                    <field name="completed" readonly="1" modifiers="{'invisible':[('visible','=', False)]}"/>
                  </tree>
                </field>
              </page>
              <page name='miembros_page' string="Miembros del proyecto">
                <field name="member_pro_ids">
                  <tree>
                    <field name="name" />
                    <field name="email" />
                  </tree>
                </field>
              </page>
            </notebook>
          </sheet>
        </form>
      </field>
    </record>

    <!--**********************Componentes***************************** -->

    <!-- Accion al ejecutar el menu de componentes -->
    <record id="action_tareas_gantt" model="ir.actions.act_window">
      <field name="name">Tareas Gantt</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">project.task</field>
      <field name="view_mode">tree,form,kanban</field>
      <field name="domain">[('pro_tipo', '=', 'tarea')]</field>
      <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
          Crear nueva tarea!
        </p>
        <p>
          Sin mensaje... 
        </p>
      </field>
    </record>

    <!-- Definición vista lista de componentes -->
    <record id="tareas_tree" model="ir.ui.view">
      <field name="name">project.task.tree</field>
      <field name="model">project.task</field>
      <field name="priority">1</field>
      <field name="arch" type="xml">
        <tree string="Tareas">
          <field name="name" />
          <field name="project_id" />
          <field name="date_start" />
          <field name="date_end" />
          <field name="pro_porcentaje_ejecucion_tarea" />
        </tree>
      </field>
    </record>


    <!-- Definición vista formulario de componentes -->
    <record id="componentes_form" model="ir.ui.view">
      <field name="name">project.task.form</field>
      <field name="model">project.task</field>
      <field name="priority">1</field>
      <field name="arch" type="xml">
        <form string="Gestion de Componentes">
          <header>
            <button type="object" id="action_close" name="action_close" class="btn btn-primary" string="Cerrar tarea" confirm="Está seguro que desea cerrar la tarea actual?" modifiers="{'invisible':[('pro_tipo','!=', 'tarea')]}"/>

          </header>
          <sheet>
            <group string="Datos Generales" class="text-primary">
              <group>
                <field name="name" string="Nombre" modifiers="{'readonly':[('ini_ejec','=',True)]}"/>
              </group>
              <group>
                <field name="pro_tipo" readonly="1" modifiers="{'invisible':[('pro_tipo','=','tarea')]}" />
                <field name="pro_tipo_tarea" string="Tipo Tarea" modifiers="{'invisible':[('pro_tipo','!=','tarea')], 'readonly':[('ini_ejec','=',True)], 'required':[('pro_tipo','=', 'tarea')]}"/>
              </group>
            </group>
            <br />
            <group>
              <group>
                <field name="pro_peso" string="Peso %" modifiers="{'invisible':[('pro_tipo','!=','componente')], 'readonly':[('ini_ejec','=',True)]}"/>
                <field name="date_end" string="Fecha fin" modifiers="{'invisible':[('pro_tipo','=','componente')], 'readonly':[('ini_ejec','=',True)]}"/>
                <field name="pro_responsable_id" string="Responsable" modifiers="{'invisible':[('pro_tipo','not in',('actividad', 'tarea'))], 'readonly':[('ini_ejec','=',True)]}"/>
                <field name="company_id" string="Compañía" invisible="1"/>
              </group>
              <group>
                <field name="ini_ejec" invisible="1" />
                <field name="is_closed" invisible="1" />
                <field name="pro_ejecutada" string="Ejecutada?" modifiers="{'invisible':['|', '|',('pro_tipo_tarea','!=','cualitativa'),('pro_tipo','!=','tarea'), ('ini_ejec', '=', False)]}"/>
                <field name="pro_porcentaje_ejecucion_tarea" string="% Ejecución" modifiers="{'invisible':['|', ('pro_tipo','!=','tarea'), ('ini_ejec', '=', False)], 'readonly':['|','|',('pro_tipo','!=','tarea'), ('pro_tipo_tarea','=','cualitativa'),('is_closed','=',True)]}"/>
                <field name="pro_porcentaje_ejecucion" string="% Ejecución" modifiers="{'invisible':[('pro_tipo','=','tarea')]}"/>
              </group>
            </group>
            <hr />
            <group col="2">
              <field colspan="2" name="pro_unidades_ids" nolabel="1" modifiers="{'invisible':[('pro_tipo','=','tarea')]}" class="text-start text-left">
                <tree editable="bottom" create="false">
                  <field name="name" readonly="1"/>
                  <field name="pro_tipo" readonly="1" invisible="1"/>
                  <field name="pro_porcentaje_ejecucion" readonly="1" widget="progressbar" string="% Ejecución" class="text-start"/>
                  <button type="object" id="action_open" name="action_open" class="btn btn-primary fa o_external_button fa-arrow-right" />
                </tree>
              </field>
            </group>
            <group>
              <button id="action_adicionar_unidad" class="btn btn-xs btn-primary" name="action_adicionar_unidad" string="Adicionar" type="object" modifiers="{'invisible':[('pro_tipo','=','tarea')]}" />
            </group>
            <notebook>
              <page string="Información general" modifiers="{'invisible':[('pro_tipo','!=','tarea')]}">
                <group>
                  <field name="pro_detalle" modifiers="{'invisible':[('pro_tipo','!=','tarea')], 'readonly':[('ini_ejec','=',True)]}"/>
                </group>
              </page>
            </notebook>
          </sheet>
        </form>
      </field>
    </record>
  </data>
</odoo>